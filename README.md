# Учебная Виртуальная Машина (УВМ)

Ассемблер и интерпретатор для учебной виртуальной машины.

## Структура проекта

- `assembler.py` - ассемблер для преобразования текстовых программ в бинарный код УВМ
- `interpreter.py` - интерпретатор для выполнения бинарных программ УВМ
- `demo.py` - демонстрационные примеры работы системы
- `test1.JSON`, `test2.JSON` - примеры программ на языке ассемблера УВМ

## Архитектура УВМ

### Компоненты виртуальной машины:
- **Аккумулятор** - специальный регистр для временного хранения данных
- **Память** - массив ячеек для хранения данных и программ
- **Счетчик команд** - указатель на следующую команду для выполнения

### Формат команд:
Все команды имеют размер 5 байт:
- Байт 0: биты 0-5 - код операции, биты 6-7 - старшие биты операнда
- Байты 1-4: младшие 4 байта операнда

## Язык ассемблера УВМ

Программы описываются в формате JSON как массив команд:

```json
[
  {"opcode": "LOAD_CONST", "operand": 42},
  {"opcode": "STORE_MEM", "operand": 100},
  {"opcode": "LOAD_MEM", "operand": 50},
  {"opcode": "ABS", "operand": 200}
]
```

##Поддерживаемые команды:
LOAD_CONST - Загрузка константы в аккумулятор
json
{"opcode": "LOAD_CONST", "operand": число}
Загружает константу в аккумулятор

Диапазон операнда: -65536 до 131071 (17 бит со знаком)

LOAD_MEM - Чтение значения из памяти
json
{"opcode": "LOAD_MEM", "operand": адрес}
Читает значение из памяти по указанному адресу в аккумулятор

Диапазон адреса: 0 до 2147483647 (31 бит)

STORE_MEM - Запись значения в память
json
{"opcode": "STORE_MEM", "operand": адрес}
Записывает значение из аккумулятора в память по указанному адресу

Диапазон адреса: 0 до 2147483647 (31 бит)

ABS - Вычисление модуля
json
{"opcode": "ABS", "operand": адрес}
Вычисляет модуль значения в аккумуляторе

Результат сохраняется в аккумулятор и записывается в память по указанному адресу

Диапазон адреса: 0 до 2147483647 (31 бит)

##Использование

1. Ассемблирование программы
bash
python assembler.py <входной_файл.json> <выходной_файл.bin> [--test]
Пример:

bash
python assembler.py test1.JSON program.bin --test
Флаг --test включает режим тестирования с выводом внутреннего представления.

2. Выполнение программы
bash
python interpreter.py <бинарный_файл.bin>
Пример:

bash
python interpreter.py program.bin

3. Демонстрация работы
   
bash

python demo.py

Примеры программ

Пример 1: Базовая работа с памятью (test1.JSON)

json
[
  {"opcode": "LOAD_CONST", "operand": 308},
  {"opcode": "STORE_MEM", "operand": 791},
  {"opcode": "LOAD_MEM", "operand": 705},
  {"opcode": "ABS", "operand": 870}
]

Пример 2: Работа с отрицательными числами (test2.JSON)

json
[
  {"opcode": "LOAD_CONST", "operand": -15},
  {"opcode": "ABS", "operand": 100},
  {"opcode": "LOAD_CONST", "operand": 42},
  {"opcode": "STORE_MEM", "operand": 200}
]


Тестирование

Ассемблер включает тесты для проверки корректности трансляции команд из спецификации УВМ:

LOAD_CONST 308 → 0x3A, 0x4D, 0x00, 0x00, 0x00

LOAD_MEM 705 → 0x53, 0xB0, 0x00, 0x00, 0x00

STORE_MEM 791 → 0xD8, 0xC5, 0x00, 0x00, 0x00

ABS 870 → 0x87, 0xD9, 0x00, 0x00, 0x00


Особенности реализации

Поддержка отрицательных чисел в команде LOAD_CONST через дополнительный код

Проверка диапазонов операндов для всех команд

Безопасный доступ к памяти с обработкой граничных случаев

Дизассемблирование бинарного кода обратно в читаемый формат

Стандартные библиотеки Python (json, struct, sys)


Автор

Нариман
